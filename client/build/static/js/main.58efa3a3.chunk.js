(this["webpackJsonpmern-client"]=this["webpackJsonpmern-client"]||[]).push([[0],{75:function(e,n,t){},78:function(e,n,t){"use strict";t.r(n);var c,a,s,r,i,o=t(1),l=t.n(o),d=t(63),j=t.n(d),m=(t(75),t(66)),u=t(89),b=t(91),h=t(88),O=t(17),x=t(6),p=t(25),f=t(26),v=t(55),g=new(function(){function e(){Object(p.a)(this,e)}return Object(f.a)(e,[{key:"getProfile",value:function(){return Object(v.a)(this.getToken())}},{key:"loggedIn",value:function(){var e=this.getToken();return!!e&&!this.isTokenExpired(e)}},{key:"isTokenExpired",value:function(e){try{return Object(v.a)(e).exp<Date.now()/1e3}catch(n){return!1}}},{key:"getToken",value:function(){return localStorage.getItem("id_token")}},{key:"login",value:function(e){localStorage.setItem("id_token",e),window.location.assign("/")}},{key:"logout",value:function(){localStorage.removeItem("id_token"),window.location.assign("/")}}]),e}()),w=t(3),N=function(){return Object(w.jsx)("header",{className:"bg-secondary mb-4 py-2 flex-row align-center",children:Object(w.jsxs)("div",{className:"container flex-row justify-space-between-lg justify-center align-center",children:[Object(w.jsx)(O.b,{to:"/",children:Object(w.jsx)("h1",{children:"NIM Portal"})}),Object(w.jsx)("nav",{className:"text-center",children:g.loggedIn()?Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)(O.b,{to:"/profile",children:"Me"}),Object(w.jsx)("a",{href:"/",onClick:function(e){e.preventDefault(),g.logout()},children:"Logout"})]}):Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)(O.b,{to:"/login",children:"Login"}),Object(w.jsx)(O.b,{to:"/signup",children:"Signup"})]})})]})})},y=function(){return Object(w.jsx)("footer",{className:"w-100 mt-auto bg-secondary p-4",children:Object(w.jsx)("div",{className:"container",children:"\xa92022 by NIM Portal"})})},k=t(8),S=t(15),C=t(12),$=t(29),_=t(9),A=t(84),T=t(33),W=t(90),I=Object(W.a)(c||(c=Object(T.a)(["\n  mutation login($email: String!, $password: String!) {\n    login(email: $email, password: $password) {\n      token\n      user {\n        _id\n        username\n      }\n    }\n  }\n"]))),L=Object(W.a)(a||(a=Object(T.a)(["\n  mutation addUser($username: String!, $email: String!, $password: String!) {\n    addUser(username: $username, email: $email, password: $password) {\n      token\n      user {\n        _id\n        username\n      }\n    }\n  }\n"]))),U=function(e){var n=Object(o.useState)({email:"",password:""}),t=Object(_.a)(n,2),c=t[0],a=t[1],s=Object(A.a)(I),r=Object(_.a)(s,2),i=r[0],l=r[1].error,d=function(e){var n=e.target,t=n.name,s=n.value;a(Object($.a)(Object($.a)({},c),{},Object(C.a)({},t,s)))},j=function(){var e=Object(S.a)(Object(k.a)().mark((function e(n){var t,s;return Object(k.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.prev=1,e.next=4,i({variables:Object($.a)({},c)});case 4:t=e.sent,s=t.data,g.login(s.login.token),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),console.error(e.t0);case 12:a({email:"",password:""});case 13:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(n){return e.apply(this,arguments)}}();return Object(w.jsx)("main",{className:"flex-row justify-center mb-4",children:Object(w.jsx)("div",{className:"col-12 col-md-6",children:Object(w.jsxs)("div",{className:"card",children:[Object(w.jsx)("h4",{className:"card-header",children:"Login"}),Object(w.jsxs)("div",{className:"card-body",children:[Object(w.jsxs)("form",{onSubmit:j,children:[Object(w.jsx)("input",{className:"form-input",placeholder:"Your email",name:"email",type:"email",id:"email",value:c.email,onChange:d}),Object(w.jsx)("input",{className:"form-input",placeholder:"******",name:"password",type:"password",id:"password",value:c.password,onChange:d}),Object(w.jsx)("button",{className:"btn d-block w-100",type:"submit",children:"Submit"})]}),l&&Object(w.jsx)("div",{children:"Login failed"})]})]})})})},B=function(){return Object(w.jsx)("div",{children:"Oops, we couldn't find that page."})},D=t(92),E=Object(W.a)(s||(s=Object(T.a)(["\n  query comments($username: String) {\n    comments(username: $username) {\n      _id\n      commentText\n      createdAt\n      username\n      reactionCount\n      reactions {\n        _id\n        createdAt\n        username\n        reactionBody\n      }\n    }\n  }\n"]))),P=Object(W.a)(r||(r=Object(T.a)(["\n  query comment($id: ID!) {\n    comment(_id: $id) {\n      _id\n      commentText\n      createdAt\n      username\n      reactionCount\n      reactions {\n        _id\n        createdAt\n        username\n        reactionBody\n      }\n    }\n  }\n"]))),R=Object(W.a)(i||(i=Object(T.a)(["\n  query user($username: String!) {\n    user(username: $username) {\n      _id\n      username\n      email\n      friendCount\n      friends {\n        _id\n        username\n      }\n      comments {\n        _id\n        commentText\n        createdAt\n        reactionCount\n      }\n    }\n  }\n"]))),q=function(e){var n=e.reactions;return Object(w.jsxs)("div",{className:"card mb-3",children:[Object(w.jsx)("div",{className:"card-header",children:Object(w.jsx)("span",{className:"text-light",children:"Reactions"})}),Object(w.jsx)("div",{className:"card-body",children:n&&n.map((function(e){return Object(w.jsxs)("p",{className:"pill mb-3",children:[e.reactionBody," ","// ",Object(w.jsxs)(O.b,{to:"/profile/".concat(e.username),style:{fontWeight:700},children:[e.username," on ",e.createdAt]})]},e._id)}))})]})},M=function(e){var n=Object(x.n)().id,t=Object(D.a)(P,{variables:{id:n}}),c=t.loading,a=t.data,s=(null===a||void 0===a?void 0:a.comment)||{};return c?Object(w.jsx)("div",{children:"Loading..."}):Object(w.jsxs)("div",{children:[Object(w.jsxs)("div",{className:"card mb-3",children:[Object(w.jsxs)("p",{className:"card-header",children:[Object(w.jsx)("span",{style:{fontWeight:700},className:"text-light",children:s.username})," ","comment on ",s.createdAt]}),Object(w.jsx)("div",{className:"card-body",children:Object(w.jsx)("p",{children:s.commentText})})]}),s.reactionCount>0&&Object(w.jsx)(q,{reactions:s.reactions})]})},Y=function(e){var n=e.comments,t=e.title;return n.length?Object(w.jsxs)("div",{children:[Object(w.jsx)("h3",{children:t}),n&&n.map((function(e){return Object(w.jsxs)("div",{className:"card mb-3",children:[Object(w.jsxs)("p",{className:"card-header",children:[Object(w.jsx)(O.b,{to:"/profile/".concat(e.username),style:{fontWeight:700},className:"text-light",children:e.username})," "," ","comment on ",e.createdAt]}),Object(w.jsx)("div",{className:"card-body",children:Object(w.jsxs)(O.b,{to:"/comment/".concat(e._id),children:[Object(w.jsx)("p",{children:e.commentText}),Object(w.jsxs)("p",{className:"mb-0",children:["Reactions: ",e.reactionCount," || Click to"," ",e.reactionCount?"see":"start"," the discussion!"]})]})})]},e._id)}))]}):Object(w.jsx)("h3",{children:"No Comments Yet"})},F=function(e){var n=e.friendCount,t=e.username,c=e.friends;return c&&c.length?Object(w.jsxs)("div",{children:[Object(w.jsxs)("h5",{children:[t,"'s ",n," ",1===n?"friend":"friends"]}),c.map((function(e){return Object(w.jsx)("button",{className:"btn w-100 display-block mb-2",children:Object(w.jsx)(O.b,{to:"/profile/".concat(e.username),children:e.username})},e._id)}))]}):Object(w.jsxs)("p",{className:"bg-dark text-light p-3",children:[t,", meet others involved with this nonprofit!"]})},J=function(){var e=Object(x.n)().username,n=Object(D.a)(R,{variables:{username:e}}),t=n.loading,c=n.data,a=(null===c||void 0===c?void 0:c.user)||{};return t?Object(w.jsx)("div",{children:"Loading..."}):Object(w.jsxs)("div",{children:[Object(w.jsx)("div",{className:"flex-row mb-3",children:Object(w.jsxs)("h2",{className:"bg-dark text-secondary p-3 display-inline-block",children:["Viewing ",a.username,"'s profile."]})}),Object(w.jsxs)("div",{className:"flex-row justify-space-between mb-3",children:[Object(w.jsx)("div",{className:"col-12 mb-3 col-lg-8",children:Object(w.jsx)(Y,{comments:a.comments,title:"".concat(a.username,"'s comments...")})}),Object(w.jsx)("div",{className:"col-12 col-lg-3 mb-3",children:Object(w.jsx)(F,{username:a.username,friendCount:a.friendCount,friends:a.friends})})]})]})},V=function(){var e=Object(o.useState)({username:"",email:"",password:""}),n=Object(_.a)(e,2),t=n[0],c=n[1],a=Object(A.a)(L),s=Object(_.a)(a,2),r=s[0],i=s[1].error,l=function(e){var n=e.target,a=n.name,s=n.value;c(Object($.a)(Object($.a)({},t),{},Object(C.a)({},a,s)))},d=function(){var e=Object(S.a)(Object(k.a)().mark((function e(n){var c,a;return Object(k.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.prev=1,e.next=4,r({variables:Object($.a)({},t)});case 4:c=e.sent,a=c.data,g.login(a.addUser.token),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),console.error(e.t0);case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(n){return e.apply(this,arguments)}}();return Object(w.jsx)("main",{className:"flex-row justify-center mb-4",children:Object(w.jsx)("div",{className:"col-12 col-md-6",children:Object(w.jsxs)("div",{className:"card",children:[Object(w.jsx)("h4",{className:"card-header",children:"Sign Up"}),Object(w.jsxs)("div",{className:"card-body",children:[Object(w.jsxs)("form",{onSubmit:d,children:[Object(w.jsx)("input",{className:"form-input",placeholder:"Your username",name:"username",type:"username",id:"username",value:t.username,onChange:l}),Object(w.jsx)("input",{className:"form-input",placeholder:"Your email",name:"email",type:"email",id:"email",value:t.email,onChange:l}),Object(w.jsx)("input",{className:"form-input",placeholder:"******",name:"password",type:"password",id:"password",value:t.password,onChange:l}),Object(w.jsx)("button",{className:"btn d-block w-100",type:"submit",children:"Submit"})]}),i&&Object(w.jsx)("div",{children:"Signup failed"})]})]})})})},z=function(){var e=Object(D.a)(E),n=e.loading,t=e.data,c=(null===t||void 0===t?void 0:t.comments)||[];return console.log(c),Object(w.jsx)("main",{children:Object(w.jsx)("div",{className:"flex-row justify-space-between",children:Object(w.jsx)("div",{className:"col-12 mb-3",children:n?Object(w.jsx)("div",{children:"Loading..."}):Object(w.jsx)(Y,{comments:c,title:"Some Feed for Comment(s)..."})})})})},G=Object(m.a)({uri:"/graphql"}),H=new u.a({link:G,cache:new b.a});var K=function(){return Object(w.jsx)(h.a,{client:H,children:Object(w.jsx)(O.a,{children:Object(w.jsxs)("div",{className:"flex-column justify-flex-start min-100-vh",children:[Object(w.jsx)(N,{}),Object(w.jsx)("div",{className:"container",children:Object(w.jsxs)(x.c,{children:[Object(w.jsx)(x.a,{path:"/",element:Object(w.jsx)(z,{})}),Object(w.jsx)(x.a,{path:"/login",element:Object(w.jsx)(U,{})}),Object(w.jsx)(x.a,{path:"/signup",element:Object(w.jsx)(V,{})}),Object(w.jsxs)(x.a,{path:"/profile",children:[Object(w.jsx)(x.a,{path:":username",element:Object(w.jsx)(J,{})}),Object(w.jsx)(x.a,{path:"",element:Object(w.jsx)(J,{})})]}),Object(w.jsx)(x.a,{path:"/comment:id",element:Object(w.jsx)(M,{})}),Object(w.jsx)(x.a,{path:"*",element:Object(w.jsx)(B,{})})]})}),Object(w.jsx)(y,{})]})})})},Q=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function X(e,n){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var t=e.installing;null!=t&&(t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),n&&n.onUpdate&&n.onUpdate(e)):(console.log("Content is cached for offline use."),n&&n.onSuccess&&n.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}j.a.render(Object(w.jsx)(l.a.StrictMode,{children:Object(w.jsx)(K,{})}),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var n="".concat("","/service-worker.js");Q?(!function(e,n){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(t){var c=t.headers.get("content-type");404===t.status||null!=c&&-1===c.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):X(e,n)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(n,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):X(n,e)}))}}()}},[[78,1,2]]]);
//# sourceMappingURL=main.58efa3a3.chunk.js.map